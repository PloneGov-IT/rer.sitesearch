"use strict";require(["jquery"],function(e){function t(){e(".solr_result_item .solrMLTPlaceHolder").fadeOut(500).html("").show(),e(".solr_result_item .solrMLTHideTarget:hidden").show(),e("a.more_like_this:hidden").show()}function a(){e("a.more_like_this").each(function(a,r){var n=e(r),s=n.parents(".solr_result_item"),i=e(this).attr("href");e(r).click(function(a){t();var r=c.clone();n.append(r),a.preventDefault(),e.ajax({url:i,data:{ajax_include_head:"1",ajax_load:"1"},success:function(t){s.find(".solrMLTHideTarget").hide(),s.find(".solrMLTPlaceHolder").hide().html(e("#content-more-like-this",t).html()).fadeIn(500),r.remove(),n.hide()},error:function(){r.remove()}})})})}var r,n,s,i,l,o=e("#search-results");1===e("input#searchGadget").length?e("input#searchGadget").val(e("input#SearchableText").attr("value")):e("input#nolivesearchGadget").val(e("input#SearchableText").attr("value")),e.fn.pullSearchResults=function(t){return this.each(function(){var r=e(this),n=e.extend({ajax_load:1},t);r.addClass("searchingLoader"),e.get("@@updated_search",n,function(n){r.hide(),0===e("#ajax-search-res").length&&e("body").append('<div id="ajax-search-res"></div>'),e("#ajax-search-res").html(n);var s=e("#ajax-search-res #search-results > *"),i=e("#ajax-search-res #updated-search-term input#SearchableText").attr("value"),l=e("#search-results-bar",n).html(),o=e("#search-results-text",n).html(),c=e("#ajax-search-res #updated-path-options").html(),h=e("#ajax-search-res #updated-sorting-options").html(),u=e("#ajax-search-res #updated-tab-options").html(),d=e("#ajax-search-res #updated-indexes-options").html();r.removeClass("searchingLoader"),r.html(s),r.fadeIn(),e("input#SearchableText").attr("value",i),1===e("input#searchGadget").length?e("input#searchGadget").val(i):e("input#nolivesearchGadget").val(i),e("#search-results-bar").html(l),e("#search-results-text").html(o),null===c&&e("#path-options").remove(),e("#sorting-options").html(h),e("#tab-options").html(u),e("#indexes-options").html(d),null===d?e("#indexes-options").hide():e("#indexes-options").show(),e("#ajax-search-res").empty(),e("#rss-subscription a.link-feed").attr("href",function(){var a=e("body").data("portalUrl");return(e("meta[name=navigation_root_url]").attr("content")||window.navigation_root_url||a)+"/search_rss?"+t}),a()})})},s=function(){var t={},a=["_authenticator"];return e("form.searchPage").serializeArray().map(function(e){-1===a.indexOf(e.name)&&""!==e.value&&(t[e.name]=e.value)}),t},n=function(t){var a=e("body").data("portalUrl"),r=(e("meta[name=navigation_root_url]").attr("content")||window.navigation_root_url||a)+"/@@search?"+e.param(t);history.pushState(null,null,r)},i="state"in window.history,l=location.href,e(window).bind("popstate",function(t){var a,n;a=!i&&location.href===l,i=!0,a||location.search&&(n=(n=(r=location.search.split("?")[1]).match(/SearchableText=[^&]*/)[0]).replace(/\+/g," "),e('#search-field input[name="SearchableText"], input#searchGadget').val(n.substr(15,n.length)),o.pullSearchResults(r))}),e('#search-filter input.searchPage[type="submit"]').hide(),e("#search-field input.searchButton").click(function(t){var a,r={};a=e('#search-field input[name="SearchableText"]').val(),r.SearchableText=a,o.pullSearchResults(r),n(r),t.preventDefault()}),e("form.searchPage").submit(function(t){var a,r={};a=e('#search-field input[name="SearchableText"]').val(),r.SearchableText=a,o.pullSearchResults(r),n(r),t.preventDefault()}),e('#search-field input[name="SearchableText"]').keyup(function(){1===e("input#searchGadget").length?e("input#searchGadget").val(e(this).val()):e("input#nolivesearchGadget").val(e(this).val())}),e("#search-results-bar dl.actionMenu > dd.actionMenuContent").click(function(e){e.stopImmediatePropagation()}),e(document).on("change","#search-filter .field input, #search-filter select",function(e){r=s(),o.pullSearchResults(r),n(r),e.preventDefault()}),e(document).on("click","#sorting-options a",function(t){e(this).attr("data-sort")?e("form.searchPage input[name='sort_on']").val(e(this).attr("data-sort")):e("form.searchPage input[name='sort_on']").val(""),r=s(),o.pullSearchResults(r),n(r),t.preventDefault()}),e(document).on("click","#search-results nav.pagination a",function(e){e.preventDefault();var t,a=this.search.split("?")[1];a.length>0&&(t=a.split("&").reduce(function(e,t){return 0===t.indexOf("b_start:int=")?t.substr("b_start:int=".length):e},0)),(r=s())["b_start:int"]=parseInt(t,10),o.pullSearchResults(r),n(r)}),e(document).on("click","#tab-options a",function(t){t.preventDefault(),e(this).attr("data-tab")?e("form.searchPage input[name='filter_tab']").val(e(this).attr("data-tab")):e("form.searchPage input[name='filter_tab']").val("all"),r=s(),(o=e("#search-results")).pullSearchResults(r),n(r)}),e(document).on("click","a.linkRemoveFilters",function(t){e(this).parent().find("input:checked").each(function(){e(this).attr("checked",!1)}),e(this).attr("class").indexOf("linkRemoveFilters")>=0&&e(this).parent().remove(),r=s(),o.pullSearchResults(r),n(r),t.preventDefault()});var c=e('<img src="'+portalUrl+'/++plone++rer.sitesearch/images/loader.gif">');e(document).ready(a)}),define("rer/sitesearch/browser/static/sitesearch.js",function(){});
//# sourceMappingURL=sitesearch-compiled.js.map